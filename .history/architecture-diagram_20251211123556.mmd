%% SafeTraveler Architecture Diagram
%% Ouvrez ce fichier sur https://mermaid.live pour gÃ©nÃ©rer l'image

graph TB
    %% Couche Utilisateur
    User[ğŸ‘¤ UTILISATEUR<br/>Navigateur Web / Mobile PWA]
    
    %% Couche PrÃ©sentation
    subgraph Presentation["ğŸ–¥ï¸ COUCHE PRÃ‰SENTATION (Next.js App Router)"]
        Home[ğŸ  Page Accueil<br/>Roadmap Carrousel]
        Navigation[ğŸ—ºï¸ Page Navigation<br/>Carte Interactive]
        Flights[âœˆï¸ Page Vols<br/>Informations]
        Report[âš ï¸ Page Signaler<br/>Incidents]
        Services[â„¹ï¸ Page Services<br/>Infos Utiles]
    end
    
    %% Couche Composants
    subgraph Components["ğŸ§© COUCHE COMPOSANTS UI"]
        subgraph Layout["Layout Components"]
            Navbar[ğŸ“± Navbar Desktop]
            BottomNav[ğŸ“± BottomNav Mobile]
        end
        
        subgraph MapComp["Map Components"]
            AirportMap[ğŸ—ºï¸ EnhancedAirportMap<br/>Mapbox GL JS]
        end
        
        subgraph UIComp["UI Components"]
            ClassModal[ğŸ« ClassSelectorModal]
            ClassFAB[ğŸ”˜ ClassFAB Button]
            LangSelector[ğŸŒ LanguageSelector]
            HeroCarousel[ğŸ  HeroCarousel]
        end
    end
    
    %% Couche Ã‰tat
    subgraph State["ğŸ’¾ COUCHE GESTION D'Ã‰TAT (Context API)"]
        PassengerCtx[ğŸ‘¤ PassengerContext<br/>â€¢ Classe passager<br/>â€¢ NumÃ©ro vol<br/>â€¢ Porte<br/>â€¢ Ã‰tape actuelle]
        LocaleCtx[ğŸŒ LocaleContext<br/>â€¢ Langue FR/EN<br/>â€¢ Traductions i18n<br/>â€¢ Fonction t]
    end
    
    %% Couche Logique
    subgraph Logic["âš™ï¸ COUCHE LOGIQUE MÃ‰TIER"]
        subgraph Utils["Utils & Services"]
            MapboxDir[ğŸ§­ mapbox-directions.ts<br/>â€¢ Calcul itinÃ©raire<br/>â€¢ Instructions<br/>â€¢ RÃ©sumÃ© trajet]
            NavUtils[ğŸ” navigation.ts<br/>â€¢ Recherche chemin<br/>â€¢ Waypoints<br/>â€¢ Filtrage]
        end
        
        subgraph Config["Types & Config"]
            PassengerTypes[ğŸ“‹ passenger.ts<br/>â€¢ PassengerClass<br/>â€¢ JourneyStep<br/>â€¢ Location types]
            Theme[ğŸ¨ theme.ts<br/>â€¢ Couleurs<br/>â€¢ Typographie<br/>â€¢ Styles]
        end
    end
    
    %% Couche DonnÃ©es
    subgraph Data["ğŸ“Š COUCHE DONNÃ‰ES"]
        subgraph StaticData["DonnÃ©es Statiques"]
            AirportData[ğŸ“ airport-data.json<br/>â€¢ 400+ lieux<br/>â€¢ CoordonnÃ©es GPS<br/>â€¢ Types & Ã©tages<br/>â€¢ Descriptions]
        end
        
        subgraph External["Services Externes"]
            MapboxAPI[ğŸ—ºï¸ Mapbox API<br/>â€¢ Cartes<br/>â€¢ Directions<br/>â€¢ GÃ©olocalisation]
            I18nMsg[ğŸŒ Messages i18n<br/>â€¢ messages/fr.json<br/>â€¢ messages/en.json]
        end
    end
    
    %% Connexions principales
    User --> Presentation
    
    Presentation --> Components
    Home --> HeroCarousel
    Home --> ClassModal
    Navigation --> AirportMap
    Navigation --> ClassFAB
    
    Components --> State
    Navbar --> LocaleCtx
    ClassModal --> PassengerCtx
    ClassFAB --> PassengerCtx
    LangSelector --> LocaleCtx
    
    State --> Logic
    PassengerCtx --> PassengerTypes
    LocaleCtx --> I18nMsg
    
    Logic --> Data
    MapboxDir --> MapboxAPI
    NavUtils --> AirportData
    AirportMap --> AirportData
    AirportMap --> MapboxAPI
    
    %% Styles
    classDef userStyle fill:#4F46E5,stroke:#312E81,stroke-width:3px,color:#fff
    classDef presentationStyle fill:#10B981,stroke:#065F46,stroke-width:2px,color:#fff
    classDef componentStyle fill:#3B82F6,stroke:#1E40AF,stroke-width:2px,color:#fff
    classDef stateStyle fill:#F59E0B,stroke:#B45309,stroke-width:2px,color:#fff
    classDef logicStyle fill:#8B5CF6,stroke:#5B21B6,stroke-width:2px,color:#fff
    classDef dataStyle fill:#EF4444,stroke:#991B1B,stroke-width:2px,color:#fff
    
    class User userStyle
    class Home,Navigation,Flights,Report,Services presentationStyle
    class Navbar,BottomNav,AirportMap,ClassModal,ClassFAB,LangSelector,HeroCarousel componentStyle
    class PassengerCtx,LocaleCtx stateStyle
    class MapboxDir,NavUtils,PassengerTypes,Theme logicStyle
    class AirportData,MapboxAPI,I18nMsg dataStyle

